let play=document.querySelector("#play"),wrapper=document.querySelector(".wrapper"),overlay=document.querySelector(".overlay"),next=document.querySelector(".finish__btn"),finishTitle=document.querySelector(".finish__title"),table=document.createElement("table"),columns=(table.classList.add("table"),3);function startGame(e){wrapper.innerHTML="",checkCells(createTable(table,makeArray(e,arrRU))),wrapper.appendChild(table),addTimer()}function createTable(e,t){e.textContent="";var n,r=[];for(n of t){var l,o=document.createElement("tr");for(l of n){var a=document.createElement("td");a.innerHTML=l,o.appendChild(a),r.push(a)}e.appendChild(o)}return r}function checkCells(e){for(var t of e)t.addEventListener("click",openCell)}play.addEventListener("click",function(){startGame(columns)}),next.addEventListener("click",function(){overlay.style.display="none",startGame(++columns)});let k=1;function openCell(){this.classList.add("active"),this.dataset.test=k,this.removeEventListener("click",openCell),k++,2==this.dataset.test&&(compareCells(),k=1)}function compareCells(){var e=document.querySelector('[data-test="1"]'),t=document.querySelector('[data-test="2"]');e.textContent!=t.textContent?(setTimeout(closeCells,500,e,t),e.addEventListener("click",openCell),t.addEventListener("click",openCell)):setTimeout(completeLevel,500),e.removeAttribute("data-test"),t.removeAttribute("data-test")}function closeCells(e,t){e.classList.remove("active"),t.classList.remove("active")}function completeLevel(){var e=document.querySelectorAll(".active"),t=document.querySelectorAll("td");e.length==t.length&&(finishTitle.textContent="Well done!",next.textContent="Next level",stopTimer(),showResults())}function showResults(){wrapper.innerHTML="",overlay.style.display="block",addResult(),5==columns&&stopGame()}function stopGame(){next.textContent="Play again",finishTitle.textContent="The game is over",columns=2}let arrRU=["А","Б","В","Г","Д","Е","Ё","Ж","З","И","Й","К","Л","М","Н","О","П","Р","С","Т","У","Ф","Х","Ц","Ч","Ш","Щ","Ь","Ы","Ъ","Э","Ю","Я"];function makeArray(e,t){var n=e*(e+1)/2;return splitArray(shuffle(doubleArr(n,pickElems(n,t))),e)}function splitArray(e,t){for(var n=[];0<e.length;)n.push(e.splice(0,t));return n}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}function pickIndx(e,t){for(var n=[];n.length<e;){var r=getRandomInt(0,t.length-1);n.includes(r)||n.push(r)}return n}function pickElems(e,t){var n,r=[];for(n of pickIndx(e,t))r.push(t[n]);return r}function doubleArr(e,t){return pickElems(e,t).concat(t)}function shuffle(e){for(var t=[];0<e.length;){var n=getRandomInt(0,e.length-1),n=e.splice(n,1)[0];t.push(n)}return t}let timer=document.createElement("p");timer.classList.add("timer");let sec,min;function setTimer(){sec=addZero(0),min=addZero(0),timer.innerHTML=min+":"+sec}let timerId;function addTimer(){wrapper.insertBefore(timer,table),setTimer(),timerId=setInterval(function(){timer.innerHTML=min+":"+addZero(++sec),59==sec&&(sec=-1,min=addZero(++min))},1e3)}function stopTimer(){clearInterval(timerId)}function addZero(e){return 0<=e&&e<=9?"0"+e:e}function addResult(){saveResult(document.querySelector("#result"))}function saveResult(e){e.textContent=min+":"+sec,setTimer()}